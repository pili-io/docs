API设计原则
==========

- 协议

API使用HTTPS作为通信协议

- 域名

API处在单独的域名下：`https://api.domain.com`

- 版本

API版本号作为HTTP Path的前缀：`https://api.domain.com/v1`

- 路径

每个路径代表一种资源，一般资源都是一个名词，集合或者集合下某个元素：`https://api.domain.com/v1/objects`或者`https://api.domain.com/v1/objects/0001`。

按照从左到右的顺序，资源应当是依次包含的关系：`https://api.domain.com/v1/bookshelves/1/book/2`

资源可以包含动作，但是动作不能包含资源：`https://api.domain.com/v1/users/actions/login`或者`https://api.domain.com/v1/book/1/actions/delete`

- 过滤信息

一般使用在获取集合类元素的API，用来过滤返回的结果。比如：`?page=2&size=10`

- 身份认证

使用OAuth2框架作为身份认证

- HTTP动词

一般只使用GET和POST两种动词：GET表示获取信息，不修改服务器数据；POST表示修改数据。

还有两个HTTP动词，主要配合浏览器操作：HEAD表示获取资源元信息；OPTIONS表示获取允许的动作。

- 数据格式

包括请求时的数据和返回的数据，统一使用JSON格式。

- 状态码

一般来说，一个API路径和一个状态码会对应唯一的一种返回结果。

200状态码表示此API调用成功，返回结果因路径而异。对于集合类元素的API，返回结果应包含集合类元素的总数。

202状态码用于异步API调用，表示接受了请求，但还没有处理完成。

204状态码表示API调用成功，但没有返回。

400状态码表示API调用时给出的参数有错误，返回的结果应当描述出具体错误的参数，以及错误原因。

401状态码表示没有调用此API的权限，返回的结果应当有更详细的错误原因。

404状态码表示API调用失败，没有找到所请求的元素。

500状态码表示API调用失败，且错误原因不在调用者，而是服务器内部状态导致的错误，返回的结果应该出错误原因。

- 错误处理

对于错误，应当给出更详细的错误原因。一般来说，返回中的`error`是统一标示的错误号，用来给用户显示错误信息，有可能信息要做国际化；而返回中的`message`是更详细的内部错误原因，用于记录日志，而不给用户显示。

- Hypermedia API

暂不考虑